# 7 排序

## 7.1 插入排序
### 7.1.1 算法
最简单的排序算法之一是 **插入排序 (insertion sort)** 。插入排序由 N - 1 趟排序组成。对于 p = 1 到 N - 1 趟，插入排序保证从位置 0 到 位置 p 上的元素为已排序状态。插入排序利用了这样的事实：已知位置 0 到位置 p - 1 上的元素已经处于排过序的状态。

在第 p 趟，我们将位置 p 上的元素向左移动，直到它在前 p + 1 个元素中的正确位置被找到的地方。

```java
public static <E extends Comparable<? super E>> void insertionSort(E[] a) {
    int j;

    for (int p = 1; p < a.length; p++) {
        // 位置 p 上的元素存储于 tmp
        E tmp = a[p];
        // p 之前所有更大的元素都被向右移动一个位置
        for (j = p; j > 0 && tmp.compareTo(a[j - 1]) < 0; j--) {
            a[j] = a[j - 1];
        }
        // tmp 被置于正确的位置上
        a[j] = tmp;
    }
}
```

### 7.1.2 插入排序的分析
由于嵌套循环的每一个都花费 N 次迭代，因此插入排序为 O(N<sup>2</sup>)，而且这个界是精确的，因为以反序的输入可以达到该界。循环中元素的比较次数对于 p 的每个值最多是 p + 1 次。

如果输入的数据已预先排序，那么运行时间为 O(N)，因为内层 for 循环的检测总是立即判定不成立而终止。事实上，如果输入几乎被排序，那么插入排序将运行得很快。由于这种变化差别很大，因此值得我们去分析该算法平均情形的行为。实际上，和各种其他排序算法一样，插入排序的平均情形也是 O(N)。